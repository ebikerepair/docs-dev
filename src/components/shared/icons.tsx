import {
  createElement,
  type FunctionComponent,
  forwardRef,
  type RefAttributes,
  type SVGProps,
} from "react";

import {
  createLucideIcon,
  type IconNode,
  icons,
  type LucideProps,
} from "lucide-react";

export type LucideIconName = keyof typeof icons;

export const DynamicLucideIcon: FunctionComponent<
  {
    icon: LucideIconName | (string & {});
  } & SVGProps<SVGSVGElement>
> = ({ icon, ...props }) => {
  if (!icon) return null;
  const CustomIcon = CUSTOM_ICON_MAP[icon as keyof typeof CUSTOM_ICON_MAP];
  if (CustomIcon) return createElement(CustomIcon, props);

  const Icon = icons[icon as LucideIconName];
  if (!Icon) return null;

  return createElement(Icon, props);
};

type LucideIconProps = Omit<LucideProps, "ref"> & RefAttributes<SVGSVGElement>;

function createCustomIcon(
  iconName: string,
  iconNode: IconNode,
  defaults: LucideIconProps = {},
): ReturnType<typeof createLucideIcon> {
  const BaseIcon = createLucideIcon(iconName, iconNode);
  return forwardRef<SVGSVGElement, LucideProps>((props, ref) => (
    <BaseIcon {...defaults} {...props} ref={ref} />
  )) as ReturnType<typeof createLucideIcon>;
}

export const GitHubIcon = createCustomIcon(
  "github",
  [
    [
      "path",
      {
        key: "github-path-1",
        d: "M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12",
      },
    ],
  ],
  { strokeWidth: 0, fill: "currentColor" },
);

export const InstagramIcon = createCustomIcon(
  "instagram",
  [
    [
      "path",
      {
        key: "instagram-path-1",
        d: "M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z",
      },
    ],
  ],
  { strokeWidth: 0.5, fill: "currentColor" },
);

export const YouTubeIcon = createCustomIcon(
  "youtube",
  [
    [
      "path",
      {
        key: "youtube-path-1",
        d: "M29.41,9.26a3.5,3.5,0,0,0-2.47-2.47C24.76,6.2,16,6.2,16,6.2s-8.76,0-10.94.59A3.5,3.5,0,0,0,2.59,9.26,36.13,36.13,0,0,0,2,16a36.13,36.13,0,0,0,.59,6.74,3.5,3.5,0,0,0,2.47,2.47C7.24,25.8,16,25.8,16,25.8s8.76,0,10.94-.59a3.5,3.5,0,0,0,2.47-2.47A36.13,36.13,0,0,0,30,16,36.13,36.13,0,0,0,29.41,9.26ZM13.2,20.2V11.8L20.47,16Z",
      },
    ],
  ],
  { strokeWidth: 0, fill: "currentColor", viewBox: "0 0 32 32" },
);

export const OpenAiIcon = createCustomIcon(
  "openai",
  [
    [
      "path",
      {
        key: "openai-path-1",
        d: "M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.872zm16.5963 3.8558L13.1038 8.364 15.1192 7.2a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.407-.667zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z",
      },
    ],
  ],
  { strokeWidth: 0, fill: "currentColor" },
);

export const AnthropicClaudeIcon = createCustomIcon(
  "anthropic-claude",
  [
    [
      "path",
      {
        key: "anthropic-claude-path-1",
        d: "M17.3041 3.541h-3.6718l6.696 16.918H24Zm-10.6082 0L0 20.459h3.7442l1.3693-3.5527h7.0052l1.3693 3.5528h3.7442L10.5363 3.5409Zm-.3712 10.2232 2.2914-5.9456 2.2914 5.9456Z",
      },
    ],
  ],
  { strokeWidth: 0, fill: "currentColor" },
);

export const MailIcon = createCustomIcon(
  "mail",
  [
    [
      "path",
      {
        key: "mail-path-1",
        d: "M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z",
      },
    ],
  ],
  { strokeWidth: 0, fill: "currentColor" },
);

export const LogoBosch = createCustomIcon(
  "logo-bosch",
  [
    [
      "path",
      {
        key: "bosch-ring",
        d: "M100.8,71.5c-26.6,0-48.2,21.6-48.2,48.2s21.6,48.2,48.2,48.2c26.6,0,48.2-21.6,48.2-48.2S127.4,71.5,100.8,71.5z M100.8,163.4c-24.1,0-43.7-19.6-43.7-43.7S76.7,76,100.8,76c24.1,0,43.7,19.6,43.7,43.7S124.9,163.4,100.8,163.4z",
      },
    ],
    [
      "path",
      {
        key: "bosch-inner",
        d: "M120.7,89.6h-3.3v16.5H84.3V89.6h-3.4c-9.7,6.5-16.2,17.5-16.2,30.1c0,12.6,6.5,23.6,16.2,30.1h3.4v-16.5h33.1v16.5h3.3c9.8-6.5,16.2-17.5,16.2-30.1C136.9,107.1,130.5,96.1,120.7,89.6z M79.7,143.3c-6.7-5.9-10.6-14.4-10.6-23.6c0-9.2,3.9-17.7,10.6-23.6V143.3z M117.4,128.7H84.3v-18.1h33.1C117.4,110.7,117.4,128.7,117.4,128.7z M121.9,143.2v-10l0,0v-27.1l0,0v-10c6.6,5.9,10.5,14.4,10.5,23.5C132.4,128.8,128.5,137.3,121.9,143.2z",
      },
    ],
  ],
  { strokeWidth: 0, fill: "currentColor", viewBox: "52.6 71.5 96.4 96.4" },
);

export const LogoShimano = createCustomIcon(
  "logo-shimano",
  [
    [
      "path",
      {
        key: "shimano-wordmark-1",
        d: "m 1166.547,819.386 v 16.205 h 4.443 V 832 h 6.518 v 3.589 h 4.444 v -16.203 h -4.444 v 9.448 h -6.518 v -9.448 z",
      },
    ],
    [
      "path",
      {
        key: "shimano-wordmark-2",
        d: "m 1163.643,819.387 h -10.993 a 4.065,4.065 0 0 0 -3.939,2.69 9.021,9.021 0 0 0 0.059,4.663 4.03,4.03 0 0 0 3.857,2.392 c 0.77,0 4.973,0 5.742,0 0.83,0 1.363,0.6 1.424,1.735 0.058,1.076 -0.356,1.913 -1.424,1.913 h -9.422 v 2.811 h 11.021 a 3.62,3.62 0 0 0 3.674,-2.452 7.857,7.857 0 0 0 0,-5.384 3.837,3.837 0 0 0 -3.792,-2.271 h -5.806 c -0.83,0 -1.3,-0.6 -1.3,-1.674 0,-1.074 0.475,-1.674 1.3,-1.674 h 9.6 z",
      },
    ],
    [
      "rect",
      {
        key: "shimano-bar-1",
        x: "1148.436",
        y: "841.01898",
        width: "33.516",
        height: "2.2872078",
      },
    ],
    [
      "rect",
      {
        key: "shimano-bar-2",
        x: "1148.436",
        y: "843.73102",
        width: "33.516",
        height: "2.2872078",
      },
    ],
    [
      "rect",
      {
        key: "shimano-bar-3",
        x: "1148.436",
        y: "846.44306",
        width: "33.516",
        height: "2.2872078",
      },
    ],
  ],
  {
    strokeWidth: 0,
    fill: "currentColor",
    // Tight viewBox around letters + bars
    viewBox: "1148.436 819.386 33.516 29.344",
  },
);

export const LogoBafang = createCustomIcon(
  "logo-bafang",
  [
    [
      "path",
      {
        key: "bafang-cutout",
        fillRule: "evenodd",
        clipRule: "evenodd",
        stroke: "none",
        d: [
          // st0 (pill) — original
          "M 147.03818,236.3",
          "c -46.6,0 -84.4,37.8 -84.4,84.4",
          "0,46.6 37.8,84.4 84.4,84.4",
          "h 34.8153",
          "c 46.6,0 84.4,-37.8 84.4,-84.4",
          "0,-46.6 -37.8,-84.4 -84.4,-84.4",

          // st1 (letters path2) — original
          "M 226.91457,296.5985",
          "h -31.8 v 20.9 h 27.8",
          "c 3.4,0 5.8,2.6 5.8,5.8",
          "0,3.2 -2.6,5.8 -5.8,5.8",
          "h -27.8 v 21.9",
          "c 0,3.7 -3,6.7 -6.7,6.7",
          "-3.7,0 -6.7,-3 -6.7,-6.7",
          "v -66.8 h 45.1",
          "c 3.7,0 6.4,2.8 6.4,6.2",
          "-0.1,3.4 -2.8,6.2 -6.3,6.2",

          // st1 (letters path4) — original (this contains the B counters)
          "M 149.8,318.1",
          "c 4.4,-3.1 7.8,-8 7.8,-13.6",
          "0,-12 -9.3,-20.3 -22.2,-20.3",
          "H 99 v 71.5 h 37.7",
          "c 12.4,0 23,-9.1 23,-21.4",
          "-0.1,-7.4 -3.9,-12.9 -9.9,-16.2",
          "M 112,295.8",
          "h 22.7",
          "c 5.4,0 9.5,3.9 9.5,9.1",
          "0,5.3 -3.8,9 -9.8,9",
          "H 111.9 V 295.8 Z",
          "M 136.2,344",
          "H 112 v -19 h 24.4",
          "c 6.2,0 10,3.8 10,9.3",
          "c -0.1,5.5 -4.3,9.7 -10.2,9.7",
        ].join(" "),
      },
    ],
  ],
  {
    // ensure NO stroke gets applied from lucide defaults
    stroke: "none",
    strokeWidth: 0,
    fill: "currentColor",
    viewBox: "62.63818 236.3 203.6153 168.8",
  },
);

export const LogoYamaha = createCustomIcon(
  "logo-yamaha",
  [
    [
      "path",
      {
        key: "yamaha-outer",
        d: "M57,107.6C29.1,107.6,6.4,84.9,6.4,57C6.4,29.1,29.1,6.4,57,6.4c27.9,0,50.6,22.6,50.6,50.6c0,0,0,0,0,0C107.6,84.9,84.9,107.6,57,107.6 M57,0C25.5,0,0,25.5,0,57s25.5,57,57,57s57-25.5,57-57S88.5,0,57,0",
      },
    ],
    [
      "path",
      {
        key: "yamaha-inner",
        d: "M75.9,67.9c-0.8,1.4-2.5,1.9-3.9,1.1c0,0,0,0,0,0l-7-4v-3.3l2.9-1.7l6.9,4C76.2,64.8,76.7,66.5,75.9,67.9 M60.3,58.9L57,60.8l-3.3-1.9v-3.8l3.3-1.9l3.3,1.9V58.9z M54.2,38c-0.1-1.6,1.1-2.9,2.7-3c1.6-0.1,2.9,1.1,3,2.7c0,0.1,0,0.2,0,0.3v8L57,47.7L54.2,46V38z M48.9,64.9l-7,4c-1.3,0.9-3.1,0.5-3.9-0.8c-0.9-1.3-0.5-3.1,0.8-3.9c0.1-0.1,0.2-0.1,0.4-0.2l7-4l2.8,1.7L48.9,64.9z M98.4,80l-8.3-9.7c-0.1-0.1-0.2-0.2-0.4-0.3c-0.4-0.2-0.9-0.2-1.3,0c-1.3,0.6-2.8,0.6-4.1-0.2c-1.1-0.6-1.9-1.7-2.1-3l0,0c-0.6-3.2-2.6-6-5.4-7.6L73.1,57l21.1-12.2l-2.6-4.5L67.9,54l-2.8-1.6V49l23.7-13.7l-2.6-4.5L65.1,43v-4.2c0-3.3-1.4-6.4-3.9-8.5c-1.9-1.6-2.1-4.4-0.5-6.2c0.2-0.3,0.5-0.6,0.9-0.8c0.4-0.3,0.6-0.7,0.6-1.2c0-0.2,0-0.3-0.1-0.5l-4.2-12c-0.2-0.5-0.7-0.7-1.1-0.6c-0.3,0.1-0.5,0.3-0.6,0.6l-4.2,12c0,0.1-0.1,0.3-0.1,0.5c0,0.5,0.2,0.9,0.6,1.2l0,0c2,1.4,2.5,4.1,1.1,6.1c-0.2,0.3-0.5,0.6-0.8,0.9c-2.5,2.1-3.9,5.2-3.9,8.5V43L27.9,30.9l-2.6,4.5L48.9,49v3.3L46.1,54L22.4,40.3l-2.6,4.5L40.9,57l-3.7,2.1c-2.8,1.6-4.8,4.4-5.4,7.6l0,0c-0.2,1.3-1,2.4-2.1,3c-1.3,0.7-2.8,0.8-4.1,0.2c-0.4-0.2-0.9-0.2-1.3,0c-0.1,0.1-0.3,0.2-0.4,0.3l-8.3,9.7c-0.3,0.4-0.3,0.9,0.1,1.2c0.2,0.2,0.5,0.3,0.8,0.2L28.9,79c0.6-0.1,1.1-0.6,1.1-1.3c0.1-1.4,0.9-2.7,2.2-3.5c1.1-0.6,2.5-0.7,3.7-0.3c3.1,1.1,6.5,0.8,9.3-0.9l3.7-2.1v24.3h5.2V67.9l2.8-1.6l2.8,1.6v27.3h5.2V71l3.7,2.1c2.8,1.6,6.2,2,9.3,0.9c1.2-0.4,2.6-0.3,3.7,0.3c1.3,0.7,2.1,2,2.2,3.5c0,0.5,0.3,0.9,0.7,1.1c0.1,0.1,0.3,0.1,0.4,0.2l12.5,2.3c0.4,0.1,0.7-0.1,0.9-0.4C98.7,80.7,98.7,80.3,98.4,80",
      },
    ],
  ],
  {
    strokeWidth: 0,
    fill: "currentColor",
    viewBox: "0 0 114 114",
  },
);

const CUSTOM_ICON_MAP = {
  LogoBosch,
  LogoShimano,
  LogoBafang,
  LogoYamaha,
};
